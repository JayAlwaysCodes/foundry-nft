//SPDX-License-Identifier: MIT

pragma solidity ^0.8.18;

import {Test, console} from "forge-std/Test.sol";
import {MoodNft} from "../../src/MoodNft.sol";
import {DeployMoodNft} from "../../script/DeployMoodNft.s.sol";

contract MoodNftIntegrationTest is Test {
    MoodNft moodNft;
    string public constant HAPPY_SVG_IMAGE_URI = "data:image/svg+xml;base64,PHN2ZyB2aWV3Qm94PSIwIDAgMjAwIDIwMCIgd2lkdGg9IjQwMCIgIGhlaWdodD0iNDAwIiB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciPgogIDxjaXJjbGUgY3g9IjEwMCIgY3k9IjEwMCIgZmlsbD0ieWVsbG93IiByPSI3OCIgc3Ryb2tlPSJibGFjayIgc3Ryb2tlLXdpZHRoPSIzIi8+CiAgPGcgY2xhc3M9ImV5ZXMiPgogICAgPGNpcmNsZSBjeD0iNjEiIGN5PSI4MiIgcj0iMTIiLz4KICAgIDxjaXJjbGUgY3g9IjEyNyIgY3k9IjgyIiByPSIxMiIvPgogIDwvZz4KICA8cGF0aCBkPSJtMTM2LjgxIDExNi41M2MuNjkgMjYuMTctNjQuMTEgNDItODEuNTItLjczIiBzdHlsZT0iZmlsbDpub25lOyBzdHJva2U6IGJsYWNrOyBzdHJva2Utd2lkdGg6IDM7Ii8+Cjwvc3ZnPg==";
    string public constant SAD_SVG_IMAGE_URI = "data:image/svg+xml;base64,Cjxzdmcgd2lkdGg9IjEwMjRweCIgaGVpZ2h0PSIxMDI0cHgiIHZpZXdCb3g9IjAgMCAxMDI0IDEwMjQiIHhtbG5zPSJodHRwOi8vd3d3LnczLm9yZy8yMDAwL3N2ZyI+CiAgPHBhdGggZmlsbD0iIzMzMyIgZD0iTTUxMiA2NEMyNjQuNiA2NCA2NCAyNjQuNiA2NCA1MTJzMjAwLjYgNDQ4IDQ0OCA0NDggNDQ4LTIwMC42IDQ0OC00NDhTNzU5LjQgNjQgNTEyIDY0em0wIDgyMGMtMjA1LjQgMC0zNzItMTY2LjYtMzcyLTM3MnMxNjYuNi0zNzIgMzcyLTM3MiAzNzIgMTY2LjYgMzcyIDM3Mi0xNjYuNiAzNzItMzcyIDM3MnoiLz4KICA8cGF0aCBmaWxsPSIjRTZFNkU2IiBkPSJNNTEyIDE0MGMtMjA1LjQgMC0zNzIgMTY2LjYtMzcyIDM3MnMxNjYuNiAzNzIgMzcyIDM3MiAzNzItMTY2LjYgMzcyLTM3Mi0xNjYuNi0zNzItMzcyLTM3MnpNMjg4IDQyMWE0OC4wMSA0OC4wMSAwIDAgMSA5NiAwIDQ4LjAxIDQ4LjAxIDAgMCAxLTk2IDB6bTM3NiAyNzJoLTQ4LjFjLTQuMiAwLTcuOC0zLjItOC4xLTcuNEM2MDQgNjM2LjEgNTYyLjUgNTk3IDUxMiA1OTdzLTkyLjEgMzkuMS05NS44IDg4LjZjLS4zIDQuMi0zLjkgNy40LTguMSA3LjRIMzYwYTggOCAwIDAgMS04LTguNGM0LjQtODQuMyA3NC41LTE1MS42IDE2MC0xNTEuNnMxNTUuNiA2Ny4zIDE2MCAxNTEuNmE4IDggMCAwIDEtOCA4LjR6bTI0LTIyNGE0OC4wMSA0OC4wMSAwIDAgMSAwLTk2IDQ4LjAxIDQ4LjAxIDAgMCAxIDAgOTZ6Ii8+CiAgPHBhdGggZmlsbD0iIzMzMyIgZD0iTTI4OCA0MjFhNDggNDggMCAxIDAgOTYgMCA0OCA0OCAwIDEgMC05NiAwem0yMjQgMTEyYy04NS41IDAtMTU1LjYgNjcuMy0xNjAgMTUxLjZhOCA4IDAgMCAwIDggOC40aDQ4LjFjNC4yIDAgNy44LTMuMiA4LjEtNy40IDMuNy00OS41IDQ1LjMtODguNiA5NS44LTg4LjZzOTIgMzkuMSA5NS44IDg4LjZjLjMgNC4yIDMuOSA3LjQgOC4xIDcuNEg2NjRhOCA4IDAgMCAwIDgtOC40QzY2Ny42IDYwMC4zIDU5Ny41IDUzMyA1MTIgNTMzem0xMjgtMTEyYTQ4IDQ4IDAgMSAwIDk2IDAgNDggNDggMCAxIDAtOTYgMHoiLz4KPC9zdmc+";
    string public constant SAD_SVG_URI = "data:application/json;base64,eyJuYW1lIjogIiBNb29kIE5GVCIsICJkZXNjcmlwdGlvbiI6ICJBbiBORlQgdGhhdCByZWZsZWN0cyB0aGUgb3duZXJzIG1vb2QuIiwgImF0dHJpYnV0ZXMiOlt7InRyYWl0X3R5cGUiOiAibW9vZGluZXNzIiwgInZhbHVlIjogMTAwfV0sICJpbWFnZSI6ICJkYXRhOmltYWdlL3N2Zyt4bWw7YmFzZTY0LENqeHpkbWNnZDJsa2RHZzlJakV3TWpSd2VDSWdhR1ZwWjJoMFBTSXhNREkwY0hnaUlIWnBaWGRDYjNnOUlqQWdNQ0F4TURJMElERXdNalFpSUhodGJHNXpQU0pvZEhSd09pOHZkM2QzTG5jekxtOXlaeTh5TURBd0wzTjJaeUkrQ2lBZ1BIQmhkR2dnWm1sc2JEMGlJek16TXlJZ1pEMGlUVFV4TWlBMk5FTXlOalF1TmlBMk5DQTJOQ0F5TmpRdU5pQTJOQ0ExTVRKek1qQXdMallnTkRRNElEUTBPQ0EwTkRnZ05EUTRMVEl3TUM0MklEUTBPQzAwTkRoVE56VTVMalFnTmpRZ05URXlJRFkwZW0wd0lEZ3lNR010TWpBMUxqUWdNQzB6TnpJdE1UWTJMall0TXpjeUxUTTNNbk14TmpZdU5pMHpOeklnTXpjeUxUTTNNaUF6TnpJZ01UWTJMallnTXpjeUlETTNNaTB4TmpZdU5pQXpOekl0TXpjeUlETTNNbm9pTHo0S0lDQThjR0YwYUNCbWFXeHNQU0lqUlRaRk5rVTJJaUJrUFNKTk5URXlJREUwTUdNdE1qQTFMalFnTUMwek56SWdNVFkyTGpZdE16Y3lJRE0zTW5NeE5qWXVOaUF6TnpJZ016Y3lJRE0zTWlBek56SXRNVFkyTGpZZ016Y3lMVE0zTWkweE5qWXVOaTB6TnpJdE16Y3lMVE0zTW5wTk1qZzRJRFF5TVdFME9DNHdNU0EwT0M0d01TQXdJREFnTVNBNU5pQXdJRFE0TGpBeElEUTRMakF4SURBZ01DQXhMVGsySURCNmJUTTNOaUF5TnpKb0xUUTRMakZqTFRRdU1pQXdMVGN1T0MwekxqSXRPQzR4TFRjdU5FTTJNRFFnTmpNMkxqRWdOVFl5TGpVZ05UazNJRFV4TWlBMU9UZHpMVGt5TGpFZ016a3VNUzA1TlM0NElEZzRMalpqTFM0eklEUXVNaTB6TGprZ055NDBMVGd1TVNBM0xqUklNell3WVRnZ09DQXdJREFnTVMwNExUZ3VOR00wTGpRdE9EUXVNeUEzTkM0MUxURTFNUzQySURFMk1DMHhOVEV1Tm5NeE5UVXVOaUEyTnk0eklERTJNQ0F4TlRFdU5tRTRJRGdnTUNBd0lERXRPQ0E0TGpSNmJUSTBMVEl5TkdFME9DNHdNU0EwT0M0d01TQXdJREFnTVNBd0xUazJJRFE0TGpBeElEUTRMakF4SURBZ01DQXhJREFnT1RaNklpOCtDaUFnUEhCaGRHZ2dabWxzYkQwaUl6TXpNeUlnWkQwaVRUSTRPQ0EwTWpGaE5EZ2dORGdnTUNBeElEQWdPVFlnTUNBME9DQTBPQ0F3SURFZ01DMDVOaUF3ZW0weU1qUWdNVEV5WXkwNE5TNDFJREF0TVRVMUxqWWdOamN1TXkweE5qQWdNVFV4TGpaaE9DQTRJREFnTUNBd0lEZ2dPQzQwYURRNExqRmpOQzR5SURBZ055NDRMVE11TWlBNExqRXROeTQwSURNdU55MDBPUzQxSURRMUxqTXRPRGd1TmlBNU5TNDRMVGc0TGpaek9USWdNemt1TVNBNU5TNDRJRGc0TGpaakxqTWdOQzR5SURNdU9TQTNMalFnT0M0eElEY3VORWcyTmpSaE9DQTRJREFnTUNBd0lEZ3RPQzQwUXpZMk55NDJJRFl3TUM0eklEVTVOeTQxSURVek15QTFNVElnTlRNemVtMHhNamd0TVRFeVlUUTRJRFE0SURBZ01TQXdJRGsySURBZ05EZ2dORGdnTUNBeElEQXRPVFlnTUhvaUx6NEtQQzl6ZG1jKyJ9";

    DeployMoodNft deployer;

    address USER = makeAddr("user");


    function setUp() public {
        deployer = new DeployMoodNft();
        moodNft = deployer.run();

    }

    function testViewTokenURIIntegration() public{
        vm.prank(USER);
        moodNft.mintNft();
        console.log(moodNft.tokenURI(0));
    }

    function testFlipTokenToSad() public {
        vm.prank(USER);
        moodNft.mintNft();

        vm.prank(USER);
        moodNft.flipMood(0);

        assertEq(keccak256(abi.encodePacked(moodNft.tokenURI(0))), keccak256(abi.encodePacked(SAD_SVG_URI)) );
    }
}